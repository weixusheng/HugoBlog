# 计算机组成原理 Part-3



存储器
<!--more--> 

# 存储器分类
**按存储介质分类**
 - 半导体存储器: TTL 、MOS -> "数据易失"
 - 磁表面存储器: 磁头、载磁体
 - 磁芯存储器: 硬磁材料、环状元件
 - 光盘存储器: 激光、磁光材料

**按存取方式分类**
1. 存取时间与物理地址无关（随机访问）
 - 随机存储器: 在程序的执行过程中可读可写
 - 只读存储器: 在程序的执行过程中只读

2. 存取时间与物理地址有关（串行访问）
 - 顺序存取存储器 磁带
 - 直接存取存储器 磁盘

**按在计算机中的作用分类**
1. 主存储器
 - RAM
   - 静态 RAM
   - 动态 RAM 
 - ROM
   - MROM
   - PROM
   - EPROM
   - EEPROM

2. Flash Memory
3. 高速缓冲存储器（Cache）
4. 辅助存储器: 磁盘、磁带、光盘

# 存储器的层次结构
![img](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/CO-3/1.png)

## 缓存 主存层次和主存 辅存层次
![img](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/CO-3/2.png)

# 主存储器
## 主存的基本组成
![img](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/CO-3/3.png)

## 主存和 CPU 的联系
![img](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/CO-3/4.png)

## 主存中存储单元地址的分配
分为大端和小端存储
![img](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/CO-3/5.png)

## 主存的技术指标
1. 存储容量: 主存存放二进制代码的总位数
2. 存储速度: 
    - 存取时间: 存储器的访问时间,读出时间,写入时间
    - 存取周期: 连续两次独立的存储器操作,（读或写）所需的最小间隔时间,"读周期,写周期"
3. 存储器的带宽: 位/秒

# 半导体芯片简介
## 基本结构
![img](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/CO-3/6.png)
![img](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/CO-3/7.png)

## 存储芯片片选线的作用
![img](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/CO-3/8.png)

## 半导体存储芯片的译码驱动方式
### 线选法
通过地址译码器传入的数字,来选择存储数据矩阵中的行
![img](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/CO-3/9.png)

### 重合法
通过传入的x和y确定一个确定的数据块
![img](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/CO-3/10.png)

# 随机存取存储器 ( RAM )
##  静态 RAM (SRAM) 
### 基本电路
静态RAM 的基本存储电路为触发器，每个触发器存放一位二进制信息，由若干个触发器组成一个存储单元，再由若干存储单元组成存储器矩阵，加上地址译码器和读／写控制电路就组成静态RAM。
存取速度快，只要不掉电即可持续保持内容不变。一般静态RAM 的集成度较低，成本较高。
![img](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/CO-3/11.png)

### RAM的 读 操作
![img](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/CO-3/12.png)

### RAM的 写 操作
![img](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/CO-3/13.png)

### Intel 2114 RAM 矩阵 (64 × 64) 读
![img](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/CO-3/14.png)

### Intel 2114 RAM 矩阵 (64 × 64) 写 
![img](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/CO-3/15.png)

## 动态 RAM ( DRAM )
动态RAM 的基本存储电路为带驱动晶体管的电容。电容上有无电荷状态被视为逻辑1和0。随着时间的推移，电容上的电荷会逐渐减少，**为保持其内容必须周期性地对其进行刷新**（对电容充电）以维持其中所存的数据，所以在硬件系统中也得设置相应的刷新电路来完成动态RAM 的刷新，这样一来无疑增加了硬件系统的复杂程度，因此在单片机应用系统中一般不使用动态RAM。
### 基本电路
![img](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/CO-3/16.png)

### 三管动态 RAM 芯片 (Intel 1103) 读
![img](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/CO-3/17.png)

### 三管动态 RAM 芯片 (Intel 1103) 写
![img](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/CO-3/18.png)

## 动态 RAM 刷新-simple
### 集中刷新-simple
存取周期为 0.5 μs
![img](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/CO-3/19.png)

### 分散刷新-simple
存取周期为 1 μs
![img](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/CO-3/20.png)

### 分散刷新与集中刷新相结合（异步刷新)-simple
将刷新放在每个小分区内,每个小分区可以看作是集中刷新
![img](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/CO-3/21.png)

## 动态 RAM 刷新-complex
 - 刷新的实质：先将原信息读出，再由刷新放大器形成原信息重新写入的再生成的过程
 - 为什么要进行刷新：存储单元被访问是随机的，有些存储单元可能长时间的不被访问，不进行存储器的读写操作，其存储单元内的原信息就可能会丢失。
 - 刷新是一行行进行的，必须在刷新周期内
 - 刷新周期：对DRAM的所有存储单元恢复一次原状态的时间间隔
 - 刷新间隔：两次刷新的起始时间差（某行从第一次刷新到第二次刷新的等待时间）
 - 行刷新间隔：两行刷新的起始时间差
 - 刷新时间：规定的一个周期内刷新的总时间
 - 刷新一行的时间是等于存取周期的。因为刷新的过程与一次存取相同，只是没有在总线上输入输出。
集中刷新

### 集中刷新
在规定的一个刷新周期内，对全部存储单元集中一段时间逐行进行刷新（用专门的时间进行全部刷新）
例对128×128的矩阵的存储芯片进行刷新，存储周期为0.5s，刷新周期为2ms
2ms的刷新周期，占得存取周期个数为：
```
2000μs÷0.5μs=4000（个）
```
共有128行要进行刷新，则刷新占128个存取周期，则刷新的时间为：
```
128×0.5μs=64μs
```
读写或维持的时间：
```
2000μs-64μs=1936μs
```
读/写或维持的存储周期为：
```
4000-128=3872（个）
```
当用64μs进行集中刷新是，此时不能进行任何的读/写操作，故将这64μs称为“死区”或“死时间”
“死时间”所占的比率也称为“死时间率”
则集中刷新的“死时间率为”
```
128÷4000×100%=3.2%
```

 - 优点：速度高
 - 缺点：存在死区，死时间长

### 分散刷新
分散刷新：是指对每行存储单元的刷新分散到每个存储周期内完成（对某一行某芯片进行读写操作后，紧接着刷新）
例：对128×128的矩阵的存储芯片进行刷新，存储周期为0.5s，
将刷新分散到存储周期内完成 ，则存储周期就包含了刷新时间
此时，存储周期为
```
t=0.5μs+0.5μs=1μs
```
刷新（刷新以行算）一行的时间为1μs，全部刷新完的时间为：
```
128×1μs=128μs
```
此时比2ms小的多

 - 优点：无死区
 - 缺点：存取周期长，整个系统的速度降低了

### 异步刷新
异步刷新：前两种方式的结合，缩短了死时间，充分利用了最大刷新间隔为2ms的特点（只要在2ms内对这一行刷新一遍就行）
例：对128×128的矩阵的存储芯片进行刷新，存储周期为0.5s，刷新周期为2ms
2ms内对每行刷新一遍：
```
2000μs÷128≈15.6μs
```
即每隔15.6μs刷新一行，每行的刷新时间仍然为0.5μs。刷新一行就停一个存储周期，“死时间缩短为0.5μs”

这种方案克服了分散刷新许独占0.5μs用于刷新，使存取周期加长且降低系统速度的缺点，又不会出现集中刷新的访问“死区”问题，从根本上提高了工作效率。

## 动态 RAM 和静态 RAM 的比较
![img](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/CO-3/22.png)









