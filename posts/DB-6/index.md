# 数据库原理及应用 PART-6



依赖关系,范式定义
<!--more-->

# 依赖关系
假设存在关系:
R(学号，姓名，性别，班级，班主任，课程号，课程名，学时数，成绩)
主键：学号+课程号
主属性：{学号，课程号}
非主属性有：{姓名，性别，班级，班主任，课程名，学时数，成绩}

## 完全函数依赖分析
成绩依赖于学号和课程号两个字段的组合；但只知道学号无法确定成绩，同理只知道课程号也无法确定成绩；只有学号和课程号组合在一起才能标识哪个学生哪门课程的成绩；
因此（学号，课程号）-> 成绩  是“完全函数依赖”。

## 部分函数依赖分析
姓名、性别和班级三个属性只依赖于主键中的学号，与“课程号”无关。
因此（学号，课程号）-> 姓名是“部分函数依赖”
（学号，课程号）-> 性别是“部分函数依赖”
（学号，课程号）-> 班级是“部分函数依赖”
课程名和学时数只依赖于课程号，
因此（学号，课程号）-> 课程名是“部分函数依赖”

## 传递函数依赖分析
班主任依赖于班级，与学号无关，与课程号也无关
又因班级依赖于学号所以班主任间接依赖于学号
因此，（学号，课程号）-> 班主任是“传递函数依赖”

# 范式定义
目前关系数据库有六种范式：
 - 第一范式（1NF）
 - 第二范式（2NF）
 - 第三范式（3NF）
 - 巴斯-科德范式（BCNF）
 - 第四范式(4NF）
 - 第五范式（5NF，又称完美范式）

  ![范式关系](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/DB-6/1.png)

 - 规范化： 一个低一级的关系模式通过模式分解可以转化为若干个高一级范式的关系模式的集合，这个过程叫做规范化。

## 第一范式
 - 如果某个域中元素被认为是不可分的,则这个域称为是原子的
 - 如果关系模式R的所有属性的域都是原子的,则R称为属于第一范式(1NF)

## 第二范式
 - 定义: 若某关系R属于第一范式，且每一个非主属性完全函数依赖于任何一个候选码，则关系R属于第二范式。
 - **主属性**: 所有候选码的属性称为主属性。不包含在任何候选码中的属性称为非主属性或非码属性。
 - 理解： 第二范式是指每个表必须有一个（有且仅有一个）数据项作为关键字或主键（primary key），其他数据项与关键字或者主键一一对应，即其他数据项完全依赖于关键字或主键。由此可知单主属性的关系均属于第二范式。
 - 判断一个关系是否属于第二范式：
    - 找出数据表中的所有码；
    - 找出所有主属性和非主属性；
    - 判断所有的非主属性对码的部分函数依赖。

## BC范式 BCNF
### 定义
 - 定义： 关系模式R<U,F>中，若每一个决定因素都包含码，则R<U,F>属于BCFN。
 - 理解： 根据定义我们可以得到结论，一个满足BC范式的关系模式有：
    - 所有非主属性对每一个码都是完全函数依赖；
    - 所有主属性对每一个不包含它的码也是完全函数依赖；
    - 没有任何属性完全函数依赖于非码的任何一组属性。

  ![BC范式](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/DB-6/2.png)

### 检查是否为BC范式
![BC范式](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/DB-6/3.png)

### BCNF分解算法
![BC范式](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/DB-6/4.png)

### BDNF与保持依赖
![BC范式](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/DB-6/5.png)

## 第三范式 3NF
### 3NF来源
![3NF](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/DB-6/6.png)

### 3NF定义
 - 定义： 非主属性既不传递依赖于码，也不部分依赖于码。
 - 理解： 第三范式要求在满足第二范式的基础上，任何非主属性不依赖于其他非主属性，即在第二范式的基础上，消除了传递依赖.

 ![3NF](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/DB-6/7.png)

### 3NF分解算法
 ![3NF](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/DB-6/8.png)

## 例题
### 例题1
![case1](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/DB-6/9.png)

### 例题2
![case2](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/DB-6/10.png)

### 例题3
![case3](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/DB-6/11.png)

## 关系数据库的设计目标
![target](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/DB-6/12.png)

## 多值依赖
![multi](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/DB-6/13.png)
![multi](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/DB-6/14.png)
![multi](https://tronwei-1254020584.cos.ap-beijing.myqcloud.com/DB-6/15.png)

## 第四范式 4NF
 - 定义： 限制关系模式的属性之间不允许有非平凡且非函数依赖的多值依赖。
 - 理解： 显然一个关系模式是4NF，则必为BCNF。也就是说，当一个表中的非主属性互相独立时（3NF），这些非主属性不应该有多值，若有多值就违反了4NF。

## 第五范式 5NF
 - 第五范式有以下要求：
    - 必须满足第四范式；
    - 表必须可以分解为较小的表，除非那些表在逻辑上拥有与原始表相同的主键。

第五范式是在第四范式的基础上做的进一步规范化。第四范式处理的是相互独立的多值情况，而第五范式则处理相互依赖的多值情况。

**这章过于理论,需要反复揣摩其中的函数关系**
**数据库撒花啦!**

