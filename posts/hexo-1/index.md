# 腾讯云COS加速静态资源


6.7-心情不太好,没学习新知识...但优化了一下静态网站的速度
6.8-今天改了一天论文,整体重复率降到了30嘿嘿,再稍微改一改,就可以快乐毕业啦(终于完成了毕业论文!)
昨天这篇blog也没写完,只好今天发了
<!--more-->

# 需求背景
由于之前hexo博客的整体资源都挂在了GitHub上,由于其与生俱来的网络速度慢,导致blog中观看图片的体验极差,我的很多"技术"(辣鸡)blog都有很多图片...所以,还是赶紧尽早优化吧
首先我想到了blog挂在云服务器上,但是价格好贵啊...而且等于重新配置一个LinuxOS的环境,想想都头疼,所以pass,去网上搜了一下,发现现在很火的对象存储似乎不错嗷,去七牛云看了一眼,有了一点思路,因为之前域名是腾讯云上买的,索性就搞腾讯云COS了,以后方便一站式管理(虽然也没方便多少),并且腾讯云价格很便宜!(穷才是真正的原因)

# 对象存储
对象存储主要就是指存储互联网时代"非结构化"数据的平台,图片,视频,音乐这类的
 - 基于云存储的概念，可以快速扩容，而且对于数据的容量的上限没有限制。这样就可以很好地应对爆发式的大量文件上传。
 - 解决了个人服务器带宽小，处理能力有限，文件读取慢的弊端，将所有的有效资源都用于数据的交互。而把静态文件的请求交给了COS对象存储进行处理。
 - COS的带宽相较于个人服务器的带宽更大，在提升页面打开速度，文件资源下载时，以及应对高并发访问，用户体验有很大提升。

综上所述,对象存储是个好东西,以后很多项目都会用上

# 腾讯云COS
## 方案1-整体部署
首先第一种解决方案是最好的,就是将hexo整体部署在COS上,这样就完全是起飞的速度,但是唯一的难点就是绑定的域名需要备案...我查了好久得出了一个结论...2020年,域名备案难于上青天,不光时间周期长,还要有一个大于六个月的云服务器,并且备案网站不可以带有"博客"字样...我大中华真的各种迷惑操作
如果有备案域名就好说了,blog上传也方便

### 安装插件
```
npm install hexo-deployer-qcloud-cos --save
```

### 配置文件
打开/_config.yml文件
```
deploy:
  type: qcloud-cos
  cosRegion: ap-chengdu
  cosSecretId: 
  cosSecretKey: 
  cosBucket: work-blog
  cosAppid:  1257072316
  remotePath: 
```
其中type：照填。
cosRegion：根据你选择的位置填写。（可从储存桶基本信息所属地域查看）
cosSecretId：填写之前创建的密钥id
cosSecretKey：填写id对应的key
cosBucket：填写储存同的名称
cosAppid：填写空间名称中的数字

### Generate-Deploy
```
hexo g && hexo d
```

然后最后绑定一下域名,就完事了

### 坑
记录一下坑,一开始COS不让绑定域名,我想你这边不让未备案绑定,那我去用域名去解析你好啦,与此同时踩坑之旅也开始啦!
不得不说还是我想的太简单,域名配置解析之后,COS不让访问,报错未解析的CNAME,应该是COS那边做了防解析
并且ssl证书也对不上,ssl证书是对应于tencent的,而不是我自己的域名
所以...还是老老实实用GitHub Pages吧

## 方案2-静态资源加速
像我这种没有备案域名的普通小辣鸡,只好另辟蹊径了
方法很简单,把图片文件都放到COS上,blog中图片放资源链接
最后我把js,css,images都放上了,并且把blog源码改了一下,就完事啦!

### 跨域访问
在COS中css等文件中一些路径可以继续使用相对地址
而在使用awesome-font时,可能会发生跨域访问错误
这时需要在"基础设置" -> "跨域访问CORS设置" 中进行设置
```
来源 Origin: * (填写一个"*",下同)
操作 Methods: PUT GET POST DELETE HEAD(全部勾选)
Allow-Headers: *
Expose-Headers: *
超时 Max-Age: 0
```
就解决啦,最后blog的访问速度起飞!解决了困扰我好久的问题




